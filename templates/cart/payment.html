{% extends 'cart/cart.html' %}

{% block inner_content %}

<div id="payment_shipping_info">

	
	
	<div id="payment-form-container" class="body-copy bootstrap">

		{% if default_ccS %}
	<div class="section-intro">
		<h2><span>Payment Methods</span></h2>
	</div>
	<div class="bootstrap existing_payment_option">
		<div>You can pay with one of your saved credit cards: </div>
		{% for cc in default_ccS %}

		<label for="cc-{{cc.id}}"><input {% if cc.is_default %} checked="checked" {% endif %}name="credit-card" value="{{cc.token}}"  data-id="{{cc.token}}" type="radio" id="cc-{{cc.id}}"> {{cc.cc_name}}</label><br>


		{% endfor %}	
		
	</div>
{% endif %}
	
	
	{% if default_ccS|length > 0%}Or <a data-target="#payment-form" class="click-reveal">enter a new credit card</a>]
	{% else %}
	Enter a Credit Card
	{% endif %}
	


		<form id="payment-form" class="form-horizontal {% if default_ccS|length > 0%}hidden{% endif %}" novalidate="novalidate">			
				
				<div class="control-group">
					<label class="control-label">First Name</label>
					<div class="controls">
						<input id="id_firstname" type="text" name="firstname" maxlength="255">
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">Last Name</label>
					<div class="controls">
						<input id="id_lastname" type="text" name="lastname" maxlength="255">
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">Street Address</label>
					<div class="controls">
						<input id="id_street" type="text" name="street" maxlength="255">
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">City</label>
					<div class="controls">
						<input id="id_city" type="text" name="city" maxlength="255">
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">State</label>
					<div class="controls">
						{% include 'cart/states_and_countries.html' %}
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">Postal / Zip Code</label>
					<div class="controls">
						<input id="id_zip" type="text" name="zip" maxlength="32">
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">Credit Card Number</label>
					<div class="controls">
						<input id="id_acct" type="text" maxlength="20">
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">Expiration Date</label>
					<div class="controls">
						<span style="white-space: nowrap"><select style="width:100px" id="id_expdate_0">
		<option value="1">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
		</select> / <select style="width:100px" id="id_expdate_1">
		<option value="2013">2013</option>
		<option value="2014">2014</option>
		<option value="2015">2015</option>
		<option value="2016">2016</option>
		<option value="2017">2017</option>
		<option value="2018">2018</option>
		<option value="2019">2019</option>
		<option value="2020">2020</option>
		<option value="2021">2021</option>
		<option value="2022">2022</option>
		<option value="2023">2023</option>
		<option value="2024">2024</option>
		<option value="2025">2025</option>
		<option value="2026">2026</option>
		</select></span>
						<span class="help-inline"></span>
					</div>
				</div>
				
				<div class="control-group">
					<label class="control-label">Card Security Code</label>
					<div class="controls">
						<input id="id_cvv2" type="text" maxlength="4">
						<span class="help-inline"></span>
					</div>
				</div>
				

				
				<div>
				</div>
				</form>

				<div >
			{% csrf_token %}
			<input id="wepay_id" type="hidden" name="credit_card_id">
			<input id="wepay_state" type="hidden" name="state">
			<input type="submit" class="btn btn-primary" value="Place an order" id="btn-place-an-order" />
		</div>
	</div>

	<form id="wepay_info" method="post" action="{% url express_checkout %}">
		{% csrf_token %}
		<input id="wepay_id" type="hidden" name="credit_card_id">
		<input id="wepay_state" type="hidden" name="state">
	</form>

<div id="shipping-form-container">
	Shipping Info
	<div class="body-copy bootstrap">
		<form action="/cart/validate_address" method="POST" id="shipping-form" class="form-horizontal">
		{% csrf_token %}

		{% if shipping_form.non_field_errors %}
            <div class="form_errors info_modal">
                {{shipping_form.non_field_errors}}

                {% if shipping_form.address_diff_list %}
                    {% with shipping_form.address_diff_list as fdl %}
                    
                    <ul class="address_confirm">
                    		<li class="heading">You entered:</li>
                    		<li class="{{fdl.address1.diff}}">{{fdl.address1.original}},</li>
          					{% if fdl.address2.original %}
                    		<li class="{{fdl.address2.diff}}">{{fdl.address2.original}},</li>
                    	{% endif %}
                    		<li class="{{fdl.city.diff}}">{{fdl.city.original}},</li>
                    		<li class="{{fdl.state.diff}}">{{fdl.state.original}},</li>
                    		<li class="{{fdl.zip_code.diff}}">{{fdl.zip_code.original}}</li>
                    		<li rel="modal:close" data-val="original" class="address_action heading">edit</li>
                    </ul>
                    <hr>
                    <ul class="address_confirm">
                    	<li class="heading">We suggest:</li>
                    	<li class="{{fdl.address1.diff}}">{{fdl.address1.suggested}},</li>
                    	{% if fdl.address2.original %}
                    	<li class="{{fdl.address2.diff}}">{{fdl.address2.suggested}},</li>
                    	{% endif %}
                    	<li class="{{fdl.city.diff}}">{{fdl.city.suggested}},</li>
                    	<li class="{{fdl.state.diff}}">{{fdl.state.suggested}},</li>
                    	<li class="{{fdl.zip_code.diff}}">{{fdl.zip_code.suggested}}</li>
                    	<li data-val="suggested" class="heading address_action">use this</li>
                    </ul>
                  <!--   <div style="width:100%;text-align:left;font-size:.6em;color:grey">
                    go with this one if possible...</div> -->
                	{% endwith %}
                {% endif %}
            </div>
            {% endif %}

		{% for field in shipping_form %}
		<div class="control-group">
			<label class="control-label">{{ field.label }}</label>
			<div class="controls">
				{{field}}
				{{field.errors}}
			</div>
		</div>
		{% endfor %}
		
	
<!-- 		<div class="control-group">
			<div class="controls">
				<label class="checkbox" style="text-transform: none">
						<input class="" type="checkbox" name="term_and_condition" id="id_term_and_condition"/>
						<a href="/terms/" target="_" class="">Terms & Condition</a>
				</label>
				<span class="help-inline"></span>
			</div>
		</div> -->
		{# <input type="submit" class="btn btn-primary" value="Place an order" id="btn-place-an-order" /> #}
		</form>
	</div>
</div>

</div>
<script type="text/javascript" src="https://wepay.com/min/js/tokenization.v2.js">
</script>
<script type="text/javascript">
	WePay.set_endpoint("{{mode}}"); // change to "production" when live
	var WEPAY_CLIENT_ID = "{{wepay_client_id}}";
	var USER_EMAIL = "{{request.user.email}}"
</script>

{% endblock %}




