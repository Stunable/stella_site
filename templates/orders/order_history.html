{% extends "retailers/retailer_base.html" %}

{% block title %} Stunable | Retailer Administration {% endblock %}

{% block body_class %}common large_common{% endblock %}
{% block content-class%}round-corner-shadow{%endblock%}

{% block inner_content %}

<div class="profile">
<div class="section-intro">
    <h2><form class="bootstrap"> <span>Order History</span>
<!--         <span style="float:right;font-size: 15px;font-weight: 400;">From:
        <input type="text" value="{{request.GET.from}}" id="datepicker-from">
        To:
        <input type="text" id="datepicker-to" value="{{request.GET.to}}">
    </span> -->
    </form>
    </h2>
</div>
<div class="body-copy common">
{% for checkout in checkouts %}
        <table id="{{checkout.ref}}">
            <tr>
                <th>Picture</th>
                <th style="width: 17%;">Purchase Date</th>
                <th style="width: 35%;">Product Name</th>
                <th style="width: 7%;">Price</th>
                <th>Size</th>
                <th>Color</th>
                <th style="width: 7%;">Quantity</th>
                <th style="width: 20%;">Status</th>
                <th style="width: 10%;">Action</th>
            </tr>
            <tr><td></td></tr>
            {% for purchase in checkout.purchase_set.all %}
            {% with item=purchase.item %}

            {% ifchanged purchase.purchased_at|date:"YMDH" %}
            <tr>
                <th colspan="3" style="width: 17%;">Reference number: {{checkout.ref}}</th>
                
                <th colspan="5">Purchased by : {{purchase.purchaser}}</th>
                <th></th>
                <th></th>
            </tr>
            {% endifchanged %}
           
            <tr id="product-item-{{item.product.pk}}">
                <td><img style="width:60px" src="{{ item.picture}}"></td>
                <td>{{ purchase.purchased_at}}</td>
                <td>{{ item.item_name }}</td>
                <td>{{ item.total_price }}</td>
                <td>{{ item.item_variation.size }}</td>
                <td>{{ item.item_variation.color }}</td>
                <td align="center">{{ item.quantity }}</td>
                <td><span class="item-status-{{item.pk}}">{{ purchase.status}}</span><br />
                    {% if purchase.status == "shipped" %} tracking no. <span class="item-tracking-no-{{item.pk}}">{% if purchase.most_recent_shipment %}#{{purchase.last_tracking_number}}{% endif %}</span>{% endif %}
                </td>
                <td>
                    {% include purchase_actions %}
                </td>
            </tr>
        {% endwith %}
        
        <br />
        {% empty %}
        <p>
            There is no entry
        </p>
        {% endfor %}
        </table>
{% endfor %}
</div>
</div>
{% endblock %}


